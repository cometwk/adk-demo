# main.go 文件分析

## 文件概述
`main.go` 是一个 Go 语言编写的 AI 编码代理程序，基于 Google 的 ADK（Agent Development Kit）框架构建。该程序创建了一个可以执行 shell 命令的智能代理，通过 LLM（大语言模型）驱动，遵循规划-执行-更新任务-报告的循环工作流程。

## 核心功能

### 1. 环境配置
- `WORKDIR`: 获取当前工作目录，用于动态生成系统提示
- `MODEL`: 从环境变量加载模型名称（`env.MustModel()`）
- `TOOLS`: 引入自定义工具集（`lib.TOOLS`）

### 2. 系统提示（System Prompt）
- 动态生成包含工作目录和运行命令（`go run main.go`）的系统提示
- 提示明确要求代理遵循：**plan → act with tools → update todos → report** 的工作流程
- 强调使用 `TodoWrite` 跟踪多步骤任务，优先使用工具而非文字描述

### 3. 任务提醒机制
- `INITIAL_REMINDER`: 对话开始时注入提醒，鼓励使用 TodoWrite
- `NAG_REMINDER`: 当超过10轮对话未更新任务时，触发二次提醒
- 这些提醒作为用户消息注入，不直接要求模型响应，是一种“软约束”

### 4. 代理初始化
- 使用 `llmagent.New` 创建 LLM 代理，配置包括：
  - 模型名称
  - 描述："CLI agent that can run shell commands."
  - 指令：动态系统提示
  - 工具集：`TOOLS`
- 使用 `launcher.Config` 和自定义 `NewLauncher()` 启动代理

### 5. 运行逻辑
- `run()` 函数负责初始化代理并启动交互式会话
- `main()` 函数仅调用 `run()`，程序入口简洁

## 设计特点
- **模块化**: 将系统提示、工具、配置分离，便于维护
- **可扩展**: 通过环境变量配置模型，适配不同后端
- **行为引导**: 通过软提醒机制引导 LLM 遵循结构化工作流程，而非硬编码约束
- **工具优先**: 明确要求使用工具执行操作，避免纯文本回答

## 使用方式
```bash
go run main.go
```

## 潜在改进方向
- 增加日志记录或调试模式
- 支持配置文件而非仅环境变量
- 增加对任务状态的持久化存储

---

> 本文件是 ADK 编程代理的核心入口，实现了结构化 AI 编程代理的典型架构。